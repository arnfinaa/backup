\documentclass[paper=a4, fontsize=11pt]{article} % A4 paper and 11pt font size
\setlength\parindent{20pt}
\usepackage{amsmath,amsfonts,amsthm}

\newtheorem{theorem}{theorem}
\newcommand{\p}{\partial}

\title{	
\normalfont \normalsize 
\textsc{UIO} \\ [25pt] % Your university, school and/or department name(s)
\horrule{0.5pt} \\[0.4cm] % Thin top horizontal rule
\huge Assignment Title \\ % The assignment title
\horrule{2pt} \\[0.5cm] % Thick bottom horizontal rule
}
\author{Arnfinn Aamodt} % Your name

\date{\normalsize\today} % Today's date or a custom date
\begin{document}
\title{Wave project, INF5620}
\maketitle

\section{Mathematical problem}

The project addresses the two-dimensional, standard, linear wave equation, with damping,
\[
\frac{\p^2 u}{\p t^2}+b\frac{\p u}{\p t} = 
	\frac{\p}{\p x}\left(q(x,y)\frac{\p u}{\p x}\right)+
	\frac{\p}{\p y}\left(q(x,y)\frac{\p u}{\p y}\right)+f(x,y,t)
\]
The associated boundary condition is
\[
\frac{\p u}{\p n}=0
\]
in a rectangular spatial domain $\Omega=[0,L_x]\times[0,L_y]$. The initial conditions are
\[
u(x,y,0)=I(x,y),\quad u_t(x,y,0)=V(x,y).
\]

\section{Discretization}

We discretize the time derivatives as
\[
\frac{\p^2 u}{\p t^2}\approx[D_tD_tu]^n_{i,j}
	=\frac{u^{n+1}_{i,j}-2u^{n}_{i,j}+u^{n-1}_{i,j}}{\Delta t^2},
\]
\[
\frac{\p u}{\p t}\approx[D_{2t}u]^n_{i,j}=\frac{u^{n+1}_{i,j}-u^{n-1}_{i,j}}{2\Delta t}.
\]
The spatial derivatives are discretized as
\[
\frac{\p u}{\p x}\left(q\frac{\p u}{\p x}\right)\approx[D_xqD_xu]^n_{i,j}
	=\frac{1}{\Delta x^2}\left(q_{i+\frac{1}{2},j}(u^{n}_{i+1,j}-u^{n}_{i,j})-
	q_{i-\frac{1}{2},j}(u^{n}_{i,j}-u^{n}_{i-1,j})\right),
\]
\[
\frac{\p u}{\p y}\left(q\frac{\p u}{\p y}\right)\approx[D_yqD_yu]^n_{i,j}
	=\frac{1}{\Delta y^2}\left(q_{i,j+\frac{1}{2}}(u^{n}_{i,j+1}-u^{n}_{i,j})-
	q_{i,j-\frac{1}{2}}(u^{n}_{i,j}-u^{n}_{i,j-1})\right).
\]
Substituting for the corresponding terms in the differential equations we get thee following difference equation
\begin{align*}
&\frac{u^{n+1}_{i,j}-2u^{n}_{i,j}+u^{n-1}_{i,j}}{\Delta t^2}
	+b\frac{u^{n+1}_{i,j}-u^{n-1}_{i,j}}{2\Delta t} \\ 
&\quad\quad =\frac{1}{\Delta x^2}\left(q_{i+\frac{1}{2},j}(u^{n}_{i+1,j}-u^{n}_{i,j})
	-q_{i-\frac{1}{2},j}(u^{n}_{i,j}-u^{n}_{i-1,j})\right) \\
&\quad\quad +\frac{1}{\Delta y^2}\left(q_{i,j+\frac{1}{2}}(u^{n}_{i,j+1}-u^{n}_{i,j})
	-q_{i,j-\frac{1}{2}}(u^{n}_{i,j}-u^{n}_{i,j-1})\right) + f^n_{i,j}.
\end{align*}
Multiplying through by $\Delta t^2$, collecting the $u^{n+1}_{i,j}$-terms on the left side, and dividing by the factor $1+\frac{b}{2}\Delta t$ gives us
\begin{align*}
u^{n+1}_{i,j}&=\bigg[2u^{n}_{i,j}-u^{n-1}_{i,j}+\frac{b}{2}u^{n-1}_{i,j}\Delta t+\frac{\Delta t^2}{\Delta x^2}\left(q_{i+\frac{1}{2},j}(u^{n}_{i+1,j}-u^{n}_{i,j})
	-q_{i-\frac{1}{2},j}(u^{n}_{i,j}-u^{n}_{i-1,j})\right) \\
&+\frac{\Delta t^2}{\Delta y^2}\left(q_{i,j+\frac{1}{2}}(u^{n}_{i,j+1}-u^{n}_{i,j})
	-q_{i,j-\frac{1}{2}}(u^{n}_{i,j}-u^{n}_{i,j-1})\right) + f^n_{i,j}\Delta t^2\bigg](1+\frac{b}{2}\Delta t)^{-1}.
\end{align*}
This is the scheme that we will use to compute $u^{n+1}_{i,j}$ at interior points. \\

For the first time step, and at the boundaries, special care must be taken, since the scheme at these points asks for values of $u$ outside the domain. The trick is to use the boundary conditions to express these values of $u$ in terms of values inside the domain.\\

For the first time step we need an expression for the value of $u^{-1}_{i,j}$. Discretizing the boundary condition $u_t(x,y,0)=V(x,y)$, we get
\[
[D_{2t}u]^0_{i,j}=\frac{u^{1}_{i,j}-u^{-1}_{i,j}}{2\Delta t}=V_{i,j},
\]
which gives
\[
u^{-1}_{i,j}=u^{1}_{i,j}-2V_{i,j}\Delta t.
\]
Inserting this into the general scheme above, we obtain the modified scheme
\begin{align*}
u^{1}_{i,j}&=\bigg[2u^{0}_{i,j}-(u^{1}_{i,j}-2V_{i,j}\Delta t)+\frac{b}{2}
	(u^{1}_{i,j}-2V_{i,j}\Delta t)\Delta t\\
&+\frac{\Delta t^2}{\Delta x^2}\left(q_{i+\frac{1}{2},j}(u^{0}_{i+1,j}-u^{0}_{i,j})
	-q_{i-\frac{1}{2},j}(u^{0}_{i,j}-u^{0}_{i-1,j})\right) \\
&+\frac{\Delta t^2}{\Delta y^2}\left(q_{i,j+\frac{1}{2}}(u^{0}_{i,j+1}-u^{0}_{i,j})
	-q_{i,j-\frac{1}{2}}(u^{0}_{i,j}-u^{0}_{i,j-1})\right) + f^n_{i,j}\Delta t^2\bigg](1+\frac{b}{2}\Delta t)^{-1}.
\end{align*}
for the first time step.\\

The von Neumann boundary conditions $\frac{\p u}{\p n}=0$ give us 
\[
u^{n}_{i-1,j}=u^{n}_{i+1,j},\quad\quad i=0,\quad i=N_x,
\]
and
\[
u^{n}_{i,j-1}=u^{n}_{i,j+1},\quad\quad j=0,\quad j=N_y.
\]
Instead of inserting these relations into our general scheme, we will just substitute the indices at the boundaries accordingly in our implementation, thus achieving the same effect.

\section{Implementation}




\end{document}